/*! tink-stick-to-top-angular v1.0.2 */
"use strict";!function(module){try{module=angular.module("tink.sticktotop")}catch(e){module=angular.module("tink.sticktotop",[])}module.directive("tinkSticky",["$timeout","$window","stickyService",function($timeout,$window,fixedCont){return{restrict:"A",link:function(scope,element,attrs){var level=1;attrs.tinkLevel&&(level=parseInt(attrs.tinkLevel)),fixedCont.register(element,level)}}}]).factory("stickyService",["$window","$timeout",function($window,$timeout){function resizeFn(){var copy=[];components.forEach(function(v,k){removeSticky(v),copy.push({elem:v.elem,level:v.level})}),components=[],stickyList=[],padding=parseInt($("body").css("padding-top"))||0,copy.forEach(function(v,l){v.elem.css("top","auto"),v.elem.removeClass(stickyClass),ctrl.register(v.elem,v.level)}),calculateValues(),update()}function update(){var scrollTop=getScrollTop()+padding;components.length;components.forEach(function(value,key){function stickyCal(){if(element.hasClass(stickyClass)&&stickyList.length>0){var lastIndex=stickyList.length-1,v=stickyList[lastIndex];if(v.stop-v.elem.outerHeight(!0)<scrollTop){var e=v.stop-scrollTop,diff=$(v.elem).outerHeight(!0)-e,diff2=padding+v.extra-diff;$(v.elem).css("top",diff2+"px")}else $(v.elem).css("top",v.extra+padding+"px")}}scrollTop+=value.extra-value.trigger;var element=$(value.elem);return scrollTop>value.top+element.outerHeight(!0)&&scrollTop>value.stop?void removeSticky(value):(stickyCal(),scrollTop>value.top&&(scrollTop<value.stop||void 0===value.stop)?addSticky(value):removeSticky(value),void stickyCal())})}function addSticky(obj){if(obj&&obj.elem){var elem=$(obj.elem);if(-1===isSticky(obj)){elem.css("z-index",obj.zindex);var topHeight=padding;obj.extra&&(topHeight+=obj.extra),obj.dummy=createDummy(elem),elem.after(obj.dummy),makeSticky(elem,topHeight),stickyList.push(obj)}}}function removeSticky(obj){if(obj&&obj.elem){var stickyIndex=($(obj.elem),isSticky(obj));if(stickyIndex>-1){var sticky=stickyList[stickyIndex];sticky.elem.css("z-index",obj.zindex),sticky.dummy.remove(),$(sticky.elem).removeClass(stickyClass),stickyList.splice(stickyIndex,1)}}}function createDummy(elem){return elem=$(elem),$("<div>").height(elem.outerHeight(!0))}function calculateValues(){var lengthC=components.length;$("nav[data-tink-top-nav]")&&$("nav[data-tink-top-nav]").css("z-index")<highLevel&&$("nav[data-tink-top-nav]").css("z-index",highLevel+2),components.forEach(function(value,key){var next=lengthC>key+1;value.extra=0,value.trigger=void 0;for(var j=key;j>0;j--){var pre=components[j-1];if(void 0===value.trigger&&(value.trigger=pre.extra),pre&&pre.level<value.level){value.extra=pre.extra+$(pre.elem).outerHeight(!0);break}if(pre&&pre.level===value.level){value.extra=pre.extra;break}}if(next){for(var i=key+1;lengthC>i;i++){var nextv=components[i];if(value.level>=nextv.level){value.stop=nextv.top;break}}void 0===value.stop,void 0===value.trigger&&(value.trigger=0)}value.zindex=highLevel+1-value.level,void 0===value.trigger&&(value.trigger=0)})}function isSticky(obj){for(var index=-1,i=stickyList.length;i--;){var objNext=stickyList[i];if($(obj.elem).get(0)===$(objNext.elem).get(0)){index=i;break}}return index}function getScrollTop(){var prop="pageYOffset",method="scrollTop";return $window?prop in $window?$window[prop]:$window.document.documentElement[method]:$window.document.body[method]}function makeSticky(elem,top){elem=$(elem),elem.addClass(stickyClass),elem.css("top",top+"px")}var padding,ctrl={},stickyClass="is-sticky",components=[],stickyList=[];$timeout(function(){padding=parseInt($("body").css("padding-top"))||0,angular.element($window).bind("scroll.sticky",function(){update()}),angular.element($window).bind("touchstart.sticky",function(){update()}),angular.element($window).bind("touchmove.sticky",function(event){update()}),angular.element($window).bind("touchend.sticky",function(event){update()}),angular.element($window).bind("resize.sticky",resizeFn),calculateValues(),update()},250),ctrl.update=function(){resizeFn.call()};var highLevel=0;return ctrl.register=function(element,level){$timeout(function(){level>highLevel&&(highLevel=level);$(element).get(0);components.push({elem:$(element),top:$(element).offset().top,level:level}),components=components.sort(function(a,b){return a=parseInt(a.top),b=parseInt(b.top),a-b}),calculateValues(),update()},250)},ctrl}])}();
//# sourceMappingURL=tink-stick-to-top-angular.min.map