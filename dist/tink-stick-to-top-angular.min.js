/*! tink-stick-to-top-angular v1.0.10 */
"use strict";!function(module){try{module=angular.module("tink.sticktotop")}catch(e){module=angular.module("tink.sticktotop",[])}module.directive("tinkSticky",["$timeout","$window","stickyService",function($timeout,$window,fixedCont){return{restrict:"A",link:function(scope,element,attrs){var level=1;attrs.tinkLevel&&(level=parseFloat(attrs.tinkLevel)),fixedCont.register(element,level),scope.$on("$destroy",function(){fixedCont.unRegister(element,level)})}}}]).factory("stickyService",["$window","$timeout",function($window,$timeout){function resizeFn(){$timeout.cancel(runResize),runResize=$timeout(function(){components.forEach(function(v){v.dummy&&stickyList.indexOf(v)>-1?v.top=$(v.dummy).offset().top:v.top=$(v.elem).offset().top}),calculateValues(),update(),update()},250)}function bindEvents(){$timeout(function(){padding=parseFloat($("body").css("padding-top"))||0,angular.element($window).bind("scroll.sticky",function(){update()}),angular.element($window).bind("touchstart.sticky",function(){update()}),angular.element($window).bind("touchmove.sticky",function(){update()}),angular.element($window).bind("touchend.sticky",function(){update()}),angular.element($window).bind("resize.sticky",resizeFn),calculateValues(),update()},250)}function unbindEvents(){angular.element($window).unbind("scroll.sticky touchstart.sticky touchmove.sticky touchend.sticky resize.sticky")}function update(){padding=parseFloat($("body").css("padding-top"))||0;var scrollTop=getScrollTop()+padding;components.forEach(function(value){function stickyCal(){var elemHeight=$(value.elem).outerHeight(!0);if(stickyList.indexOf(value)>-1&&(elemHeight=$(value.dummy).outerHeight(!0)),element.hasClass(stickyClass)&&stickyList.length>0){var lastIndex=stickyList.length-1,v=stickyList[lastIndex];if(v.stop-elemHeight<scrollTop){var e=v.stop-scrollTop,diff=elemHeight-e,diff2=padding+v.extra-diff;$(v.elem).css("top",diff2+"px")}else{var topHeight=padding;value.extra&&(topHeight+=value.extra),$(value.elem).css("top",topHeight+"px"),$(v.elem).css("top",v.extra+padding+"px")}}}scrollTop+=value.extra-value.trigger;var element=$(value.elem);return scrollTop>value.top+element.outerHeight(!0)&&scrollTop>value.stop?void removeSticky(value):(stickyCal(),parseFloat(scrollTop.toFixed(3))>parseFloat(value.top.toFixed(3))&&(scrollTop<value.stop||void 0===value.stop)?addSticky(value):removeSticky(value),void stickyCal())})}function addSticky(obj){if(obj&&obj.elem){var elem=$(obj.elem);if(-1===isSticky(obj)){var topHeight=padding;obj.extra&&(topHeight+=obj.extra),obj.dummy=createDummy(elem),elem.after(obj.dummy),makeSticky(elem,topHeight,obj.level),stickyList.push(obj)}}}function removeSticky(obj){if(obj&&obj.elem){var stickyIndex=isSticky(obj);if(stickyIndex>-1){var sticky=stickyList[stickyIndex];sticky.elem.css("z-index",""),sticky.dummy.remove(),$(sticky.elem).removeClass(stickyClass),stickyList.splice(stickyIndex,1)}}}function createDummy(elem){return elem=$(elem),elem=elem.clone(),elem.css("opacity","0"),$(elem)}function calculateValues(){var lengthC=components.length;components.forEach(function(value,key){var next=lengthC>key+1;value.extra=0,value.trigger=void 0;for(var j=key;j>0;j--){var pre=components[j-1];if(void 0===value.trigger&&(value.trigger=pre.extra),pre&&pre.level<value.level){value.extra=pre.extra+$(pre.elem).outerHeight(!0);break}if(pre&&pre.level===value.level){value.extra=pre.extra;break}}if(next){for(var i=key+1;lengthC>i;i++){var nextv=components[i];if(value.level>=nextv.level){value.stop=nextv.top;break}}void 0===value.stop,void 0===value.trigger&&(value.trigger=0)}value.zindex=highLevel+1-value.level,void 0===value.trigger&&(value.trigger=0)})}function isSticky(obj){for(var index=-1,i=stickyList.length;i--;){var objNext=stickyList[i];if($(obj.elem).get(0)===$(objNext.elem).get(0)){index=i;break}}return index}function getScrollTop(){var prop="pageYOffset",method="scrollTop";return $window?prop in $window?$window[prop]:$window.document.documentElement[method]:$window.document.body[method]}function makeSticky(elem,top,level){elem=$(elem),elem.addClass(stickyClass);var maxZIndex=elem.css("z-index");elem.css("z-index",maxZIndex-(level-1)),elem.css("top",top+"px")}var padding,runResize,ctrl={},stickyClass="is-sticky",components=[],stickyList=[];bindEvents(),ctrl.update=function(){resizeFn.call()};var highLevel=0;return ctrl.unRegister=function(element,level){for(var i=0;i<components.length;i++)components[i].elem.get(0)===element.get(0)&&(components.splice(i,1),i=99);0===components.length&&unbindEvents()},ctrl.register=function(element,level){$timeout(function(){level>highLevel&&(highLevel=level),components.push({elem:$(element),top:$(element).offset().top,level:level}),components=components.sort(function(a,b){return a=parseFloat(a.top),b=parseFloat(b.top),a-b}),1===components.length&&bindEvents(),calculateValues(),update()},250)},ctrl}])}();
//# sourceMappingURL=tink-stick-to-top-angular.min.map